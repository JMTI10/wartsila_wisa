-- Single Plant Engines Dummy Data Population
-- Populates engines and all related tables with realistic data
-- 3 engines for one plant: 1 natural gas engine + 2 methane engines
-- 10 records per engine with 24h intervals

-- Insert engines (3 engines for plant PP-001)
INSERT INTO engines (plant_id, model, nameplate_capacity, status) VALUES
-- Plant PP-001 engines
('PP-001', 'GE Frame 7FA Gas Turbine', 185.0, 'active'),        -- Natural gas engine
('PP-001', 'Caterpillar CG260-16 Methane Engine', 4.3, 'active'), -- Methane engine 1
('PP-001', 'MWM TCG 2032 V16 Methane Engine', 4.0, 'active');     -- Methane engine 2

-- Generate fuel consumption records (10 records per engine, 24h apart)
-- Engine 1 uses natural gas (fuel_id = 2)
INSERT INTO engine_fuel_consumption (engine_id, fuel_id, measurement_date, consumption_rate, consumption_rate_unit, annual_consumption, fuel_cost_per_day, annual_consumption_unit, fuel_energy_input) VALUES
-- Engine 1 (Natural Gas - 185MW)
(1, 2, '2024-01-01', 42500, 'm³/hour', 372300000, 28500, 'm³/year', 442),
(1, 2, '2024-01-02', 41800, 'm³/hour', 366168000, 28000, 'm³/year', 434),
(1, 2, '2024-01-03', 43200, 'm³/hour', 378432000, 29000, 'm³/year', 449),
(1, 2, '2024-01-04', 42100, 'm³/hour', 368796000, 28200, 'm³/year', 437),
(1, 2, '2024-01-05', 43600, 'm³/hour', 381936000, 29300, 'm³/year', 453),
(1, 2, '2024-01-06', 41500, 'm³/hour', 363540000, 27800, 'm³/year', 431),
(1, 2, '2024-01-07', 42900, 'm³/hour', 375924000, 28800, 'm³/year', 446),
(1, 2, '2024-01-08', 42300, 'm³/hour', 370548000, 28400, 'm³/year', 440),
(1, 2, '2024-01-09', 43100, 'm³/hour', 377556000, 28900, 'm³/year', 448),
(1, 2, '2024-01-10', 41900, 'm³/hour', 367044000, 28100, 'm³/year', 435),

-- Engine 2 (Methane - 4.3MW)
(2, 6, '2024-01-01', 985, 'm³/hour', 8628600, 660, 'm³/year', 10.2),
(2, 6, '2024-01-02', 968, 'm³/hour', 8479680, 650, 'm³/year', 10.0),
(2, 6, '2024-01-03', 1002, 'm³/hour', 8777520, 672, 'm³/year', 10.4),
(2, 6, '2024-01-04', 978, 'm³/hour', 8567280, 656, 'm³/year', 10.1),
(2, 6, '2024-01-05', 1010, 'm³/hour', 8847600, 678, 'm³/year', 10.5),
(2, 6, '2024-01-06', 962, 'm³/hour', 8427120, 646, 'm³/year', 9.98),
(2, 6, '2024-01-07', 995, 'm³/hour', 8716200, 668, 'm³/year', 10.3),
(2, 6, '2024-01-08', 985, 'm³/hour', 8628600, 660, 'm³/year', 10.2),
(2, 6, '2024-01-09', 1005, 'm³/hour', 8803800, 674, 'm³/year', 10.4),
(2, 6, '2024-01-10', 972, 'm³/hour', 8514720, 652, 'm³/year', 10.1),

-- Engine 3 (Methane - 4.0MW)
(3, 6, '2024-01-01', 916, 'm³/hour', 8028160, 614, 'm³/year', 9.5),
(3, 6, '2024-01-02', 901, 'm³/hour', 7896760, 602, 'm³/year', 9.35),
(3, 6, '2024-01-03', 932, 'm³/hour', 8168320, 628, 'm³/year', 9.67),
(3, 6, '2024-01-04', 909, 'm³/hour', 7962840, 608, 'm³/year', 9.43),
(3, 6, '2024-01-05', 940, 'm³/hour', 8238400, 632, 'm³/year', 9.75),
(3, 6, '2024-01-06', 894, 'm³/hour', 7835440, 598, 'm³/year', 9.28),
(3, 6, '2024-01-07', 925, 'm³/hour', 8107000, 620, 'm³/year', 9.6),
(3, 6, '2024-01-08', 916, 'm³/hour', 8028160, 614, 'm³/year', 9.5),
(3, 6, '2024-01-09', 934, 'm³/hour', 8185840, 630, 'm³/year', 9.69),
(3, 6, '2024-01-10', 905, 'm³/hour', 7927800, 606, 'm³/year', 9.39);

-- Generate engine generation records (10 records per engine, 24h apart)
INSERT INTO engine_generation (engine_id, measurement_date, gross_generation, net_generation, auxiliary_power, operating_hours, capacity_factor) VALUES
-- Engine 1 (Natural Gas - 185MW)
(1, '2024-01-01', 1620000, 1554000, 66000, 8760, 95.1),
(1, '2024-01-02', 1598400, 1533840, 64560, 8650, 93.8),
(1, '2024-01-03', 1641600, 1574640, 66960, 8870, 96.5),
(1, '2024-01-04', 1609200, 1543680, 65520, 8700, 94.4),
(1, '2024-01-05', 1652400, 1585920, 66480, 8930, 97.1),
(1, '2024-01-06', 1587600, 1523040, 64560, 8580, 92.5),
(1, '2024-01-07', 1630800, 1564560, 66240, 8810, 95.8),
(1, '2024-01-08', 1620000, 1554000, 66000, 8760, 95.1),
(1, '2024-01-09', 1641600, 1574640, 66960, 8870, 96.5),
(1, '2024-01-10', 1598400, 1533840, 64560, 8650, 93.8),

-- Engine 2 (Methane - 4.3MW)
(2, '2024-01-01', 37668, 36120, 1548, 8760, 95.1),
(2, '2024-01-02', 37152, 35636, 1516, 8650, 93.8),
(2, '2024-01-03', 38184, 36654, 1530, 8870, 96.5),
(2, '2024-01-04', 37410, 35904, 1506, 8700, 94.4),
(2, '2024-01-05', 38442, 36900, 1542, 8930, 97.1),
(2, '2024-01-06', 36894, 35388, 1506, 8580, 92.5),
(2, '2024-01-07', 37926, 36378, 1548, 8810, 95.8),
(2, '2024-01-08', 37668, 36120, 1548, 8760, 95.1),
(2, '2024-01-09', 38184, 36654, 1530, 8870, 96.5),
(2, '2024-01-10', 37152, 35636, 1516, 8650, 93.8),

-- Engine 3 (Methane - 4.0MW)
(3, '2024-01-01', 35040, 33600, 1440, 8760, 95.1),
(3, '2024-01-02', 34560, 33120, 1440, 8650, 93.8),
(3, '2024-01-03', 35520, 34080, 1440, 8870, 96.5),
(3, '2024-01-04', 34800, 33360, 1440, 8700, 94.4),
(3, '2024-01-05', 35760, 34320, 1440, 8930, 97.1),
(3, '2024-01-06', 34320, 32880, 1440, 8580, 92.5),
(3, '2024-01-07', 35280, 33840, 1440, 8810, 95.8),
(3, '2024-01-08', 35040, 33600, 1440, 8760, 95.1),
(3, '2024-01-09', 35520, 34080, 1440, 8870, 96.5),
(3, '2024-01-10', 34560, 33120, 1440, 8650, 93.8);

-- Generate stack emissions records (CO2, NOx, SOx for each engine)
-- CO2 emissions
INSERT INTO engine_stack_emissions (engine_id, measurement_date, pollutant_type, concentration, mass_rate, annual_total) VALUES
-- Engine 1 CO2 (Natural Gas)
(1, '2024-01-01', 'co2', 3500, 86200, 755432),
(1, '2024-01-02', 'co2', 3450, 84700, 742212),
(1, '2024-01-03', 'co2', 3580, 87800, 769488),
(1, '2024-01-04', 'co2', 3520, 85400, 748344),
(1, '2024-01-05', 'co2', 3620, 88500, 775620),
(1, '2024-01-06', 'co2', 3430, 84100, 736956),
(1, '2024-01-07', 'co2', 3560, 87200, 764232),
(1, '2024-01-08', 'co2', 3540, 86000, 753680),
(1, '2024-01-09', 'co2', 3590, 87600, 767736),
(1, '2024-01-10', 'co2', 3470, 84900, 743964),

-- Engine 2 CO2 (Methane)
(2, '2024-01-01', 'co2', 3400, 2000, 17520),
(2, '2024-01-02', 'co2', 3380, 1965, 17213),
(2, '2024-01-03', 'co2', 3420, 2035, 17827),
(2, '2024-01-04', 'co2', 3390, 1980, 17345),
(2, '2024-01-05', 'co2', 3440, 2050, 17958),
(2, '2024-01-06', 'co2', 3370, 1950, 17082),
(2, '2024-01-07', 'co2', 3410, 2020, 17696),
(2, '2024-01-08', 'co2', 3400, 2000, 17520),
(2, '2024-01-09', 'co2', 3425, 2040, 17889),
(2, '2024-01-10', 'co2', 3385, 1970, 17257),

-- Engine 3 CO2 (Methane)
(3, '2024-01-01', 'co2', 3400, 1860, 16306),
(3, '2024-01-02', 'co2', 3380, 1828, 16021),
(3, '2024-01-03', 'co2', 3420, 1892, 16586),
(3, '2024-01-04', 'co2', 3390, 1844, 16161),
(3, '2024-01-05', 'co2', 3440, 1908, 16718),
(3, '2024-01-06', 'co2', 3370, 1812, 15885),
(3, '2024-01-07', 'co2', 3410, 1876, 16446),
(3, '2024-01-08', 'co2', 3400, 1860, 16306),
(3, '2024-01-09', 'co2', 3425, 1900, 16653),
(3, '2024-01-10', 'co2', 3385, 1836, 16091);

-- NOx emissions
INSERT INTO engine_stack_emissions (engine_id, measurement_date, pollutant_type, concentration, mass_rate, annual_total) VALUES
-- Engine 1 NOx (Natural Gas)
(1, '2024-01-01', 'nox', 25, 51.7, 453),
(1, '2024-01-02', 'nox', 24, 50.8, 445),
(1, '2024-01-03', 'nox', 26, 52.6, 461),
(1, '2024-01-04', 'nox', 25, 51.2, 449),
(1, '2024-01-05', 'nox', 27, 53.1, 465),
(1, '2024-01-06', 'nox', 24, 50.3, 441),
(1, '2024-01-07', 'nox', 26, 52.2, 457),
(1, '2024-01-08', 'nox', 25, 51.5, 451),
(1, '2024-01-09', 'nox', 26, 52.4, 459),
(1, '2024-01-10', 'nox', 24, 50.9, 446),

-- Engine 2 NOx (Methane)
(2, '2024-01-01', 'nox', 22, 1.2, 10.5),
(2, '2024-01-02', 'nox', 21, 1.18, 10.3),
(2, '2024-01-03', 'nox', 23, 1.22, 10.7),
(2, '2024-01-04', 'nox', 22, 1.19, 10.4),
(2, '2024-01-05', 'nox', 24, 1.25, 11.0),
(2, '2024-01-06', 'nox', 21, 1.17, 10.2),
(2, '2024-01-07', 'nox', 23, 1.21, 10.6),
(2, '2024-01-08', 'nox', 22, 1.2, 10.5),
(2, '2024-01-09', 'nox', 23, 1.23, 10.8),
(2, '2024-01-10', 'nox', 21, 1.18, 10.3),

-- Engine 3 NOx (Methane)
(3, '2024-01-01', 'nox', 22, 1.12, 9.8),
(3, '2024-01-02', 'nox', 21, 1.10, 9.6),
(3, '2024-01-03', 'nox', 23, 1.14, 10.0),
(3, '2024-01-04', 'nox', 22, 1.11, 9.7),
(3, '2024-01-05', 'nox', 24, 1.16, 10.2),
(3, '2024-01-06', 'nox', 21, 1.09, 9.5),
(3, '2024-01-07', 'nox', 23, 1.13, 9.9),
(3, '2024-01-08', 'nox', 22, 1.12, 9.8),
(3, '2024-01-09', 'nox', 23, 1.15, 10.1),
(3, '2024-01-10', 'nox', 21, 1.10, 9.6);

-- SOx emissions (minimal for gas engines)
INSERT INTO engine_stack_emissions (engine_id, measurement_date, pollutant_type, concentration, mass_rate, annual_total) VALUES
-- Engine 1 SOx (Natural Gas)
(1, '2024-01-01', 'sox', 0.5, 1.0, 8.8),
(1, '2024-01-02', 'sox', 0.5, 1.0, 8.7),
(1, '2024-01-03', 'sox', 0.5, 1.1, 9.6),
(1, '2024-01-04', 'sox', 0.5, 1.0, 8.8),
(1, '2024-01-05', 'sox', 0.5, 1.1, 9.6),
(1, '2024-01-06', 'sox', 0.5, 1.0, 8.8),
(1, '2024-01-07', 'sox', 0.5, 1.0, 8.8),
(1, '2024-01-08', 'sox', 0.5, 1.0, 8.8),
(1, '2024-01-09', 'sox', 0.5, 1.1, 9.6),
(1, '2024-01-10', 'sox', 0.5, 1.0, 8.8),

-- Engine 2 SOx (Methane)
(2, '2024-01-01', 'sox', 0.3, 0.023, 0.20),
(2, '2024-01-02', 'sox', 0.3, 0.022, 0.19),
(2, '2024-01-03', 'sox', 0.3, 0.024, 0.21),
(2, '2024-01-04', 'sox', 0.3, 0.023, 0.20),
(2, '2024-01-05', 'sox', 0.3, 0.025, 0.22),
(2, '2024-01-06', 'sox', 0.3, 0.022, 0.19),
(2, '2024-01-07', 'sox', 0.3, 0.024, 0.21),
(2, '2024-01-08', 'sox', 0.3, 0.023, 0.20),
(2, '2024-01-09', 'sox', 0.3, 0.024, 0.21),
(2, '2024-01-10', 'sox', 0.3, 0.022, 0.19),

-- Engine 3 SOx (Methane)
(3, '2024-01-01', 'sox', 0.3, 0.021, 0.18),
(3, '2024-01-02', 'sox', 0.3, 0.020, 0.18),
(3, '2024-01-03', 'sox', 0.3, 0.022, 0.19),
(3, '2024-01-04', 'sox', 0.3, 0.021, 0.18),
(3, '2024-01-05', 'sox', 0.3, 0.023, 0.20),
(3, '2024-01-06', 'sox', 0.3, 0.020, 0.18),
(3, '2024-01-07', 'sox', 0.3, 0.022, 0.19),
(3, '2024-01-08', 'sox', 0.3, 0.021, 0.18),
(3, '2024-01-09', 'sox', 0.3, 0.022, 0.19),
(3, '2024-01-10', 'sox', 0.3, 0.020, 0.18);

-- Generate particulate matter emissions (10 records per engine)
INSERT INTO engine_particulate_emissions (engine_id, measurement_date, pm10_rate, pm25_rate, total_pm_annual) VALUES
-- Engine 1 (Natural Gas)
(1, '2024-01-01', 1.7, 0.9, 14.9),
(1, '2024-01-02', 1.7, 0.9, 14.7),
(1, '2024-01-03', 1.8, 0.9, 15.1),
(1, '2024-01-04', 1.7, 0.9, 14.8),
(1, '2024-01-05', 1.8, 0.9, 15.2),
(1, '2024-01-06', 1.7, 0.8, 14.6),
(1, '2024-01-07', 1.7, 0.9, 14.9),
(1, '2024-01-08', 1.7, 0.9, 14.8),
(1, '2024-01-09', 1.8, 0.9, 15.0),
(1, '2024-01-10', 1.7, 0.9, 14.7),

-- Engine 2 (Methane)
(2, '2024-01-01', 0.039, 0.021, 0.34),
(2, '2024-01-02', 0.038, 0.020, 0.33),
(2, '2024-01-03', 0.040, 0.021, 0.35),
(2, '2024-01-04', 0.039, 0.020, 0.34),
(2, '2024-01-05', 0.041, 0.022, 0.36),
(2, '2024-01-06', 0.037, 0.020, 0.32),
(2, '2024-01-07', 0.040, 0.021, 0.35),
(2, '2024-01-08', 0.039, 0.021, 0.34),
(2, '2024-01-09', 0.040, 0.021, 0.35),
(2, '2024-01-10', 0.038, 0.020, 0.33),

-- Engine 3 (Methane)
(3, '2024-01-01', 0.036, 0.019, 0.32),
(3, '2024-01-02', 0.035, 0.019, 0.31),
(3, '2024-01-03', 0.037, 0.020, 0.33),
(3, '2024-01-04', 0.036, 0.019, 0.32),
(3, '2024-01-05', 0.038, 0.020, 0.34),
(3, '2024-01-06', 0.034, 0.018, 0.30),
(3, '2024-01-07', 0.037, 0.020, 0.33),
(3, '2024-01-08', 0.036, 0.019, 0.32),
(3, '2024-01-09', 0.037, 0.020, 0.33),
(3, '2024-01-10', 0.035, 0.019, 0.31);

-- Generate other emissions (mercury, heavy metals, VOCs - minimal for gas/methane)
INSERT INTO engine_other_emissions (engine_id, measurement_date, pollutant_type, annual_total) VALUES
-- Mercury emissions (minimal for gas engines)
-- Engine 1 (Natural Gas)
(1, '2024-01-01', 'mercury', 0.8),
(1, '2024-01-02', 'mercury', 0.8),
(1, '2024-01-03', 'mercury', 0.8),
(1, '2024-01-04', 'mercury', 0.8),
(1, '2024-01-05', 'mercury', 0.8),
(1, '2024-01-06', 'mercury', 0.8),
(1, '2024-01-07', 'mercury', 0.8),
(1, '2024-01-08', 'mercury', 0.8),
(1, '2024-01-09', 'mercury', 0.8),
(1, '2024-01-10', 'mercury', 0.8),

-- Engine 2 (Methane)
(2, '2024-01-01', 'mercury', 0.018),
(2, '2024-01-02', 'mercury', 0.018),
(2, '2024-01-03', 'mercury', 0.018),
(2, '2024-01-04', 'mercury', 0.018),
(2, '2024-01-05', 'mercury', 0.018),
(2, '2024-01-06', 'mercury', 0.018),
(2, '2024-01-07', 'mercury', 0.018),
(2, '2024-01-08', 'mercury', 0.018),
(2, '2024-01-09', 'mercury', 0.018),
(2, '2024-01-10', 'mercury', 0.018),

-- Engine 3 (Methane)
(3, '2024-01-01', 'mercury', 0.017),
(3, '2024-01-02', 'mercury', 0.017),
(3, '2024-01-03', 'mercury', 0.017),
(3, '2024-01-04', 'mercury', 0.017),
(3, '2024-01-05', 'mercury', 0.017),
(3, '2024-01-06', 'mercury', 0.017),
(3, '2024-01-07', 'mercury', 0.017),
(3, '2024-01-08', 'mercury', 0.017),
(3, '2024-01-09', 'mercury', 0.017),
(3, '2024-01-10', 'mercury', 0.017);

-- Heavy metals emissions (minimal for gas/methane engines)
INSERT INTO engine_other_emissions (engine_id, measurement_date, pollutant_type, annual_total) VALUES
-- Engine 1 (Natural Gas)
(1, '2024-01-01', 'heavy_metals', 2.1),
(1, '2024-01-02', 'heavy_metals', 2.1),
(1, '2024-01-03', 'heavy_metals', 2.1),
(1, '2024-01-04', 'heavy_metals', 2.1),
(1, '2024-01-05', 'heavy_metals', 2.1),
(1, '2024-01-06', 'heavy_metals', 2.1),
(1, '2024-01-07', 'heavy_metals', 2.1),
(1, '2024-01-08', 'heavy_metals', 2.1),
(1, '2024-01-09', 'heavy_metals', 2.1),
(1, '2024-01-10', 'heavy_metals', 2.1),

-- Engine 2 (Methane)
(2, '2024-01-01', 'heavy_metals', 0.049),
(2, '2024-01-02', 'heavy_metals', 0.049),
(2, '2024-01-03', 'heavy_metals', 0.049),
(2, '2024-01-04', 'heavy_metals', 0.049),
(2, '2024-01-05', 'heavy_metals', 0.049),
(2, '2024-01-06', 'heavy_metals', 0.049),
(2, '2024-01-07', 'heavy_metals', 0.049),
(2, '2024-01-08', 'heavy_metals', 0.049),
(2, '2024-01-09', 'heavy_metals', 0.049),
(2, '2024-01-10', 'heavy_metals', 0.049),

-- Engine 3 (Methane)
(3, '2024-01-01', 'heavy_metals', 0.046),
(3, '2024-01-02', 'heavy_metals', 0.046),
(3, '2024-01-03', 'heavy_metals', 0.046),
(3, '2024-01-04', 'heavy_metals', 0.046),
(3, '2024-01-05', 'heavy_metals', 0.046),
(3, '2024-01-06', 'heavy_metals', 0.046),
(3, '2024-01-07', 'heavy_metals', 0.046),
(3, '2024-01-08', 'heavy_metals', 0.046),
(3, '2024-01-09', 'heavy_metals', 0.046),
(3, '2024-01-10', 'heavy_metals', 0.046);

-- VOCs emissions (minimal for gas/methane engines)
INSERT INTO engine_other_emissions (engine_id, measurement_date, pollutant_type, annual_total) VALUES
-- Engine 1 (Natural Gas)
(1, '2024-01-01', 'vocs', 15.4),
(1, '2024-01-02', 'vocs', 15.2),
(1, '2024-01-03', 'vocs', 15.6),
(1, '2024-01-04', 'vocs', 15.3),
(1, '2024-01-05', 'vocs', 15.7),
(1, '2024-01-06', 'vocs', 15.1),
(1, '2024-01-07', 'vocs', 15.5),
(1, '2024-01-08', 'vocs', 15.4),
(1, '2024-01-09', 'vocs', 15.6),
(1, '2024-01-10', 'vocs', 15.2),

-- Engine 2 (Methane)
(2, '2024-01-01', 'vocs', 0.36),
(2, '2024-01-02', 'vocs', 0.35),
(2, '2024-01-03', 'vocs', 0.37),
(2, '2024-01-04', 'vocs', 0.36),
(2, '2024-01-05', 'vocs', 0.38),
(2, '2024-01-06', 'vocs', 0.34),
(2, '2024-01-07', 'vocs', 0.37),
(2, '2024-01-08', 'vocs', 0.36),
(2, '2024-01-09', 'vocs', 0.37),
(2, '2024-01-10', 'vocs', 0.35),

-- Engine 3 (Methane)
(3, '2024-01-01', 'vocs', 0.34),
(3, '2024-01-02', 'vocs', 0.33),
(3, '2024-01-03', 'vocs', 0.35),
(3, '2024-01-04', 'vocs', 0.34),
(3, '2024-01-05', 'vocs', 0.36),
(3, '2024-01-06', 'vocs', 0.32),
(3, '2024-01-07', 'vocs', 0.35),
(3, '2024-01-08', 'vocs', 0.34),
(3, '2024-01-09', 'vocs', 0.35),
(3, '2024-01-10', 'vocs', 0.33);

-- Verify the data insertion with a comprehensive query
SELECT 
    e.engine_id,
    e.model,
    e.nameplate_capacity,
    e.status,
    f.fuel_name,
    COUNT(DISTINCT efc.consumption_id) as fuel_consumption_records,
    COUNT(DISTINCT eg.generation_id) as generation_records,
    COUNT(DISTINCT ese.emission_id) as stack_emission_records,
    COUNT(DISTINCT epe.particulate_id) as particulate_emission_records,
    COUNT(DISTINCT eoe.other_emission_id) as other_emission_records
FROM engines e
LEFT JOIN engine_fuel_consumption efc ON e.engine_id = efc.engine_id
LEFT JOIN engine_generation eg ON e.engine_id = eg.engine_id
LEFT JOIN engine_stack_emissions ese ON e.engine_id = ese.engine_id
LEFT JOIN engine_particulate_emissions epe ON e.engine_id = epe.engine_id
LEFT JOIN engine_other_emissions eoe ON e.engine_id = eoe.engine_id
LEFT JOIN fuels f ON efc.fuel_id = f.fuel_id
WHERE e.plant_id = 'PP-001'
GROUP BY e.engine_id, e.model, e.nameplate_capacity, e.status, f.fuel_name
ORDER BY e.engine_id;